using Microsoft.Contracts;

class TmplTest {

    // ------------------------------------------------------------------   
    //  Tests
    // ------------------------------------------------------------------   
    
    [Verify(true)]
    static int m0(int arg1, int x)
	ensures result == 42;
    {
 	//Inc(ref arg1, ?!);
	?!{repeat: 1, ifbranches: 1, branchops: 1, conjunctions: 1, ops: {Inc}, condvars: {}, argvars: {}}
	return arg1;
    }

    [Verify(true)]
    static int m1(int arg1, int x, int y)
	ensures y == 5 ==> result == 42;
        ensures y != 5 ==> result == 7;
    {
// 	if (?!(y) && ?!(y))
// 	    Inc(ref arg1, ?!);
// 	else
// 	    Inc(ref arg1, ?!);
	?!{repeat: 1, ifbranches: 2, branchops: 1, conjunctions: 2, ops: {Inc}, condvars: {y}, argvars: {}}
	return arg1;
    }
    
    // ------------------------------------------------------------------   
    //  Operations
    // ------------------------------------------------------------------   

//     [Verify(false)]
//     operation transformable void Op1(transformable int arg1, int arg2, transformable int[]! arg3) { }
  
//     [Verify(false)]
    static operation void Inc(ref int arg1, transformable int x) 
    ensures x == 5 ==> arg1 == 42;
    ensures x == 4 ==> arg1 == 7;
    ensures (x != 5 && x != 4) ==> arg1 == 0;
    { 
	if (x == 5)
	    arg1 = 42;
	else if (x == 4)
	    arg1 = 7;
	else
	    arg1 = 0;
    }

    /*
    DOES NOT WORK YET:

    */

    [Verify(false)]
    TmplTest() { }

    [Verify(false)]
    public static void Main(string[] args) { }

}